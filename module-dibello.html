<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>dibello.js Module: dibello</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />


	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">
	<link type="text/css" rel="stylesheet" href="styles/site.yeti.css">
	<link type="text/css" rel="stylesheet" href="styles/skate.css">
</head>

<body class="loading">

<div class="navbar navbar-default navbar-fixed-top navbar-inverse">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">dibello.js</a>
	</div>
	<div class="navbar-collapse">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu inline">
					<li><a href="module-dibello.html">dibello</a></li><li><a href="module-dibello_utils_annotateFn.html">dibello/utils/annotateFn</a></li><li><a href="module-dibello_utils_lightinjector.html">dibello/utils/lightinjector</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu inline">
					<li><a href="module-dibello.Constraint.html">dibello.Constraint</a></li><li><a href="module-dibello.Database.html">dibello.Database</a></li><li><a href="module-dibello.IDBCursorGenerator.html">dibello.IDBCursorGenerator</a></li><li><a href="module-dibello.IDBRequestGenerator.html">dibello.IDBRequestGenerator</a></li><li><a href="module-dibello.Repository.html">dibello.Repository</a></li><li><a href="module-dibello.SchemaBuilder.html">dibello.SchemaBuilder</a></li><li><a href="module-dibello.StoreBuilder.html">dibello.StoreBuilder</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b class="caret"></b></a>
				<ul class="dropdown-menu inline">
					<li><a href="global.html#injector">injector</a></li><li><a href="global.html#stripCopy">stripCopy</a></li><li><a href="global.html#transact">transact</a></li>
				</ul>
			</li>
			
		</ul>
	</div>
</div>
</div>


<div class="container">
<div class="row">

	
		<div class="col-md-3">
			<div id="toc" class="col-md-3"></div>
		</div>
	

	<div class="clearfix"></div>

	
	<div class="col-md-8">
	
		<div id="main">
			

<section>

<header>
    
</header>


<article>
    <div class="container-overview">
    
        
            <div class="description"><h1>dibello</h1><p>The main module of Dibello, an IndexedDB ORM library.</p></div>
        

        
<dl class="details">
	

	

	

	

    

    

    

    

	

	
	<dt class="tag-author">Author:</dt>
	<dd class="tag-author">
		<ul>
			<li><a href="mailto:wilahti@gmail.com">William Lahti</a></li>
			</ul>
	</dd>
	

	
	<dt class="tag-copyright">Copyright:</dt>
	<dd class="tag-copyright">
		<ul class="dummy">
			<li>(C) 2015 William Lahti</li>
		</ul>
	</dd>
	

	

	



	

	

	

	
</dl>


        
    
    </div>

    

    

    
        <h3 class="subsection-title">Classes</h3>

        <dl>
            <dt><a href="module-dibello.Constraint.html">Constraint</a></dt>
            <dd></dd>
        
            <dt><a href="module-dibello.Database.html">Database</a></dt>
            <dd></dd>
        
            <dt><a href="module-dibello.IDBCursorGenerator.html">IDBCursorGenerator</a></dt>
            <dd></dd>
        
            <dt><a href="module-dibello.IDBRequestGenerator.html">IDBRequestGenerator</a></dt>
            <dd></dd>
        
            <dt><a href="module-dibello.Repository.html">Repository</a></dt>
            <dd></dd>
        
            <dt><a href="module-dibello.SchemaBuilder.html">SchemaBuilder</a></dt>
            <dd></dd>
        
            <dt><a href="module-dibello.StoreBuilder.html">StoreBuilder</a></dt>
            <dd></dd>
        </dl>
    

    

    

    
        <h3 class="subsection-title">Members</h3>

        <dl>
            
<dt class="name" id=".version">
    <h4><span class="type-signature">&lt;static> </span>version<span class="type-signature"> :String</span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>Contains the version of the Dibello library.</p>
    </div>
    

    
        <h5>Type:</h5>
        <ul>
            <li>
                
<span class="param-type">String</span>
 
    
            </li>
        </ul>
    

    
<dl class="details">
	

	

	

	

    

    

    

    

	

	

	

	

	



	

	

	

	
</dl>


    
</dd>

        </dl>
    

    
        <h3 class="subsection-title">Methods</h3>

        <dl>
            
<dt>
    <h4 class="name" id=".open"><span class="type-signature">&lt;static> </span> open<span class="signature">(string, object)</span><span class="type-signature"> &rarr; {Promise|<a href="module-dibello.Database.html">module:dibello.Database</a>}</span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Returns a promise to open an IndexedDB database using Dibello's schema manager.</p>
<p>You must pass the top-level indexedDB API object. If you are in a browser which
supports IndexedDB, then simply pass window.indexedDB. If you are in Node.js 
using indexeddb-js, then you should pass the indexeddbjs.indexedDB instance you
normally construct.</p>
<p>When the promise resolves you will receive a dibello.Database instance.</p>
<p>In order for Dibello to prepare the database, you must provide the desired IDB 
database name and a set of options.</p>
<p>Migrations</p>
<p>The most important option is 'migrations', which must be an
object with numeric keys, one for each revision of the database.
The 'version' option chooses what version of the schema Dibello 
should consider current. During open(), Dibello will apply the 
schema you define within your migrations functions to the given
IDB database. </p>
<p>Since Dibello only knows about your database schema through your migrations,
they are structured in a particular way. You cannot interact with data within
the database during a migration unless you are within a run() block. This is 
because your migrations are <em>always run</em> to construct a model of your schema. 
The IDB database is only modified when a version migration operation is underway,
and this includes run() blocks. </p>
<p>Because of this, you should not attempt to do anything other than modify the 
schema using the SchemaBuilder instance you are given when you are outside of a run()
block!</p>
<p>Example:</p>
<pre class="prettyprint source lang-js"><code>dibello.open('apples', {
        migrations: {
            '1': function(schema) {
                // This is our perfect apples schema.
                // We're very sure right now that this won't need to be changed.

                schema.createStore('apples')
                    .id('id'),
                    .key('color')
                    .field('history')
                ;
            },
            '2': function(schema) {
                // Let's add a size key, we didn't realize we needed it before

                schema.getStore('apples')
                    .key('size')
                ;
            },
            '3': function(schema) {

                // Change 'size' from a bunch of strings to a numeric type

                schema.getStore('apples')
                    .run(function(apples) {
                        apples.all().emit(function(apple) {
                            var map = { small: 2, medium: 3, large: 4, 'extra-large': 5 };

                            if (apple.size) {
                                var neuSize = map[apple.size];
                                apple.size = neuSize;
                            }

                            apples.persist(apple);
                        });
                    })
                ;
            },
        }
}).then(function(db) {
        // Hey, lets use it!

        db.transact(function(apples) {
            apples.find({
                size: 'large'
            }).emit(function(apple) {
                console.log('Found a large apple!', apple);
            });
        })
});</code></pre>
    </div>
    

    

    
    
    
    
        <h5>Parameters:</h5>
        

<div class="params-mobile">
	
			<div style="margin-left:0.5em;border-left:5px solid #ccc;margin-bottom:0.5em;">
				<label class="columnar"><code>string</code></label>
				

				

				

				<div style="margin-left:1em;margin-top:0.25em;">
					<p>dbName</p>
				</div>
				
				</div>
			
			<div style="margin-left:0.5em;border-left:5px solid #ccc;margin-bottom:0.5em;">
				<label class="columnar"><code>object</code></label>
				

				

				

				<div style="margin-left:1em;margin-top:0.25em;">
					<p>options</p>
				</div>
				
				</div>
			
		<br/>
</div>
<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>string</code></td>
            

            <td class="type">
            
            </td>

            

            

            <td class="description last"><p>dbName</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>object</code></td>
            

            <td class="type">
            
            </td>

            

            

            <td class="description last"><p>options</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

    

    

    

    

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            


<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type">Promise</span>
| 

<span class="param-type"><a href="module-dibello.Database.html">module:dibello.Database</a></span>
 
    
	</dd>
</dl>


        
    
    
</dd>

        
            
<dt>
    <h4 class="name" id=".repository"><span class="type-signature">&lt;static> </span> repository<span class="signature">(db, storeName)</span><span class="type-signature"> &rarr; {<a href="module-dibello.Repository.html">module:dibello.Repository</a>}</span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Create a new repository object for the given database and object store.</p>
    </div>
    

    

    
    
    
    
        <h5>Parameters:</h5>
        

<div class="params-mobile">
	
			<div style="margin-left:0.5em;border-left:5px solid #ccc;margin-bottom:0.5em;">
				<label class="columnar"><code>db</code></label>
				
					<span style="display:inline-block;margin-left:0.25em;">
						
<span class="param-type">IDBDatabase</span>
 
    
					</span>
				

				

				

				<div style="margin-left:1em;margin-top:0.25em;">
					
				</div>
				
				</div>
			
			<div style="margin-left:0.5em;border-left:5px solid #ccc;margin-bottom:0.5em;">
				<label class="columnar"><code>storeName</code></label>
				
					<span style="display:inline-block;margin-left:0.25em;">
						
<span class="param-type">type</span>
 
    
					</span>
				

				

				

				<div style="margin-left:1em;margin-top:0.25em;">
					
				</div>
				
				</div>
			
		<br/>
</div>
<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>db</code></td>
            

            <td class="type">
            
                
<span class="param-type">IDBDatabase</span>
 
    
            
            </td>

            

            

            <td class="description last"></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>storeName</code></td>
            

            <td class="type">
            
                
<span class="param-type">type</span>
 
    
            
            </td>

            

            

            <td class="description last"></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

    

    

    

    

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            


<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type"><a href="module-dibello.Repository.html">module:dibello.Repository</a></span>
 
    
	</dd>
</dl>


        
    
    
</dd>

        </dl>
    

    

    
</article>

</section>




		</div>
	</div>


</div>
</div>


<footer>

	&nbsp;&nbsp;&nbsp;Thanks for reading this far!
	<br />


	<span class="copyright">
	Copyright © 2015 The contributors to the Skate project
	</span>
	<br />

<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a>
	on Mon Aug 24th 2015 using the <a
	href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
</span>
</footer>

<!--<script src="scripts/sunlight.js"></script>-->
<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/bootstrap-dropdown.js"></script>
<script src="scripts/toc.js"></script>

<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "h1,h2,h3,h4",
		showAndHide : false,
		scrollTo    : "100px"
	} );

	$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();
	//			$( ".tutorial-section pre, .readme-section pre" ).addClass( "sunlight-highlight-javascript" ).addClass( "linenums" );

	$( ".tutorial-section pre, .readme-section pre" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			lang = "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : true,
		showMenu : true,
		enableDoclinks : true
	} );
} );
</script>



<!--Navigation and Symbol Display-->

<script>
	$( function () {
		$( '#main' ).localScroll( {
			offset : { top : 60 } //offset by the height of your header (give or take a few px, see what works for you)
		} );
		$( "dt.name" ).each( function () {
			var $this = $( this ).find("h4");
			var icon = $( "<i/>" ).addClass( "icon-plus-sign" ).addClass( "pull-right" ).addClass( "icon-white" );
			var dt = $(this);
			var children = dt.next( "dd" );

			dt.prepend( icon ).css( {cursor : "pointer"} );
			dt.addClass( "member-collapsed" ).addClass( "member" );


			children.hide();

			dt.children().on( "click", function () {
				children = dt.next( "dd" );
				children.slideToggle( "fast", function () {

					if ( children.is( ":visible" ) ) {
						icon.addClass( "icon-minus-sign" ).removeClass( "icon-plus-sign" ).removeClass( "icon-white" );
						dt.addClass( "member-open" ).animate( "member-collapsed" );
					} else {
						icon.addClass( "icon-plus-sign" ).removeClass( "icon-minus-sign" ).addClass( "icon-white" );
						dt.addClass( "member-collapsed" ).removeClass( "member-open" );
					}
				} );
			} );

		} );
	} );
</script>

<script>
	$(function () {

		$('a[href^="module-"]').each(function() {
			var text = $(this).text();
			text = text.replace(/module:/g, '');
 
			$(this).css('margin', '0 0.2em');
			$(this).text(text);
		});

		$('body').removeClass('loading');
	});
</script>

<!--Google Analytics-->


</body>
</html>